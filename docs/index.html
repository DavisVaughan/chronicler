<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="The functions provided by this package allow you to decorate your functions to provide logging.">
<title>Add Logging to Functions • chronicler</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Add Logging to Functions">
<meta property="og:description" content="The functions provided by this package allow you to decorate your functions to provide logging.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">chronicler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/advanced-topics.html">An implementation of the logger monad</a>
    <a class="dropdown-item" href="articles/real-world-example.html">A real world example</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/b-rodrigues/chronicler/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="chronicler">chronicler<a class="anchor" aria-label="anchor" href="#chronicler"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>Easily add logs to your functions.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"b-rodrigues/chronicler"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>{chronicler}</code> provides the <code><a href="reference/record.html">record()</a></code> function, which allows you to decorate functions. These decorated functions then work exactly the same as their undecorated counterparts, but they provide additional output.</p>
<p>Let’s first start with a simple example, by decorating the <code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">chronicler</span><span class="op">)</span>

<span class="va">r_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">sqrt</span><span class="op">)</span>

<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">r_sqrt</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>Object <code>a</code> is now an object of class <code>chronicle</code>. Let’s see what <code>a</code> is:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span>
<span class="co">#&gt; ✔ Value computed successfully:</span>
<span class="co">#&gt; ---------------</span>
<span class="co">#&gt; Just</span>
<span class="co">#&gt; [1] 1.000000 1.414214 1.732051 2.000000 2.236068</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---------------</span>
<span class="co">#&gt; This is an object of type `chronicle`.</span>
<span class="co">#&gt; Retrieve the value of this object with pick(.c, "value").</span>
<span class="co">#&gt; To read the log of this object, call read_log().</span></code></pre></div>
<p><code>a</code> is now made up of several parts. The first part:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>✔ Value computed successfully<span class="sc">:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="sc">---------------</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Just</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.000000</span> <span class="fl">1.414214</span> <span class="fl">1.732051</span> <span class="fl">2.000000</span> <span class="fl">2.236068</span></span></code></pre></div>
<p>simply provides the result of <code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt()</a></code> applied to <code>1:5</code> (let’s ignore the word <code>Just</code> on the third line for now; for more details see the <code>Maybe Monad</code> vignette). The second part, tells you that there’s more to it:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">---------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>This is an object of type <span class="st">`</span><span class="at">chronicle</span><span class="st">`</span>.</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Retrieve the value of this object with <span class="fu">pick</span>(.c, <span class="st">"value"</span>).</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>To read the log of this object, call <span class="fu">read_log</span>().</span></code></pre></div>
<p>The value of the <code><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt()</a></code> function applied to its arguments can be obtained using <code><a href="reference/pick.html">pick()</a></code>, as explained:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/pick.html">pick</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"value"</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.000000 1.414214 1.732051 2.000000 2.236068</span></code></pre></div>
<p>A log also gets generated and can be read using <code><a href="reference/read_log.html">read_log()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/read_log.html">read_log</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>
<span class="co">#&gt; [1] "Complete log:"                                   </span>
<span class="co">#&gt; [2] "✔ sqrt() ran successfully at 2022-04-23 13:04:42"</span>
<span class="co">#&gt; [3] "Total running time: 0.00039362907409668 secs"</span></code></pre></div>
<p>This is especially useful for objects that get created using multiple calls:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">sqrt</span><span class="op">)</span>
<span class="va">r_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span>
<span class="va">r_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> |&gt;
  <span class="fu">r_sqrt</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="reference/bind_record.html">bind_record</a></span><span class="op">(</span><span class="va">r_exp</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="reference/bind_record.html">bind_record</a></span><span class="op">(</span><span class="va">r_mean</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/read_log.html">read_log</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
<span class="co">#&gt; [1] "Complete log:"                                   </span>
<span class="co">#&gt; [2] "✔ sqrt() ran successfully at 2022-04-23 13:04:42"</span>
<span class="co">#&gt; [3] "✔ exp() ran successfully at 2022-04-23 13:04:42" </span>
<span class="co">#&gt; [4] "✔ mean() ran successfully at 2022-04-23 13:04:42"</span>
<span class="co">#&gt; [5] "Total running time: 0.0180156230926514 secs"</span>

<span class="fu"><a href="reference/pick.html">pick</a></span><span class="op">(</span><span class="va">b</span>, <span class="st">"value"</span><span class="op">)</span>
<span class="co">#&gt; [1] 11.55345</span></code></pre></div>
<p><code><a href="reference/record.html">record()</a></code> works with any function (as far as I know).</p>
<p>To avoid having to define every function individually, like this:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">sqrt</span><span class="op">)</span>
<span class="va">r_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span>
<span class="va">r_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></code></pre></div>
<p>you can use the <code><a href="reference/record_many.html">record_many()</a></code> function. <code><a href="reference/record_many.html">record_many()</a></code> takes a list of functions (as strings) as an input and puts generated code in your system’s clipboard. You can then paste the code into your text editor. The gif below illustrates how <code><a href="reference/record_many.html">record_many()</a></code> works:</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/b-rodrigues/chronicler/master/data-raw/record_many.gif" alt=""><p class="caption"><code><a href="reference/record_many.html">record_many()</a></code> in action</p>
</div>
</div>
<div class="section level2">
<h2 id="composing-decorated-functions">Composing decorated functions<a class="anchor" aria-label="anchor" href="#composing-decorated-functions"></a>
</h2>
<p><code><a href="reference/bind_record.html">bind_record()</a></code> is used to pass the output from one decorated function to the next:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

<span class="va">r_group_by</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">group_by</span><span class="op">)</span>
<span class="va">r_select</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">select</span><span class="op">)</span>
<span class="va">r_summarise</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">summarise</span><span class="op">)</span>
<span class="va">r_filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">filter</span><span class="op">)</span>

<span class="va">output</span> <span class="op">&lt;-</span> <span class="va">starwars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">r_select</span><span class="op">(</span><span class="va">height</span>, <span class="va">mass</span>, <span class="va">species</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="reference/bind_record.html">bind_record</a></span><span class="op">(</span><span class="va">r_group_by</span>, <span class="va">species</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="reference/bind_record.html">bind_record</a></span><span class="op">(</span><span class="va">r_filter</span>, <span class="va">sex</span> <span class="op">!=</span> <span class="st">"male"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="reference/bind_record.html">bind_record</a></span><span class="op">(</span><span class="va">r_summarise</span>,
              mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mass</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
              <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/read_log.html">read_log</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span>
<span class="co">#&gt; [1] "Complete log:"                                                                </span>
<span class="co">#&gt; [2] "✔ select(height,mass,species,sex) ran successfully at 2022-04-23 13:04:42"    </span>
<span class="co">#&gt; [3] "✔ group_by(species,sex) ran successfully at 2022-04-23 13:04:42"              </span>
<span class="co">#&gt; [4] "✔ filter(sex != \"male\") ran successfully at 2022-04-23 13:04:42"            </span>
<span class="co">#&gt; [5] "✔ summarise(mean(mass, na.rm = TRUE)) ran successfully at 2022-04-23 13:04:42"</span>
<span class="co">#&gt; [6] "Total running time: 0.128485441207886 secs"</span></code></pre></div>
<p>The value can then be accessed and worked on as usual using <code><a href="reference/pick.html">pick()</a></code>, as explained above:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/pick.html">pick</a></span><span class="op">(</span><span class="va">output</span>, <span class="st">"value"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 × 3</span>
<span class="co">#&gt; # Groups:   species [9]</span>
<span class="co">#&gt;   species    sex              mass</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Clawdite   female           55  </span>
<span class="co">#&gt; 2 Droid      none             69.8</span>
<span class="co">#&gt; 3 Human      female           56.3</span>
<span class="co">#&gt; 4 Hutt       hermaphroditic 1358  </span>
<span class="co">#&gt; 5 Kaminoan   female          NaN  </span>
<span class="co">#&gt; 6 Mirialan   female           53.1</span>
<span class="co">#&gt; 7 Tholothian female           50  </span>
<span class="co">#&gt; 8 Togruta    female           57  </span>
<span class="co">#&gt; 9 Twi'lek    female           55</span></code></pre></div>
<p>This package also ships with a dedicated pipe, <code>%&gt;=%</code> which you can use instead of <code><a href="reference/bind_record.html">bind_record()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output_pipe</span> <span class="op">&lt;-</span> <span class="va">starwars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">r_select</span><span class="op">(</span><span class="va">height</span>, <span class="va">mass</span>, <span class="va">species</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span>
  <span class="fu">r_group_by</span><span class="op">(</span><span class="va">species</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span>
  <span class="fu">r_filter</span><span class="op">(</span><span class="va">sex</span> <span class="op">!=</span> <span class="st">"male"</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span>
  <span class="fu">r_summarise</span><span class="op">(</span>mean_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mass</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/pick.html">pick</a></span><span class="op">(</span><span class="va">output_pipe</span>, <span class="st">"value"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 × 3</span>
<span class="co">#&gt; # Groups:   species [9]</span>
<span class="co">#&gt;   species    sex            mean_mass</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;              &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Clawdite   female              55  </span>
<span class="co">#&gt; 2 Droid      none                69.8</span>
<span class="co">#&gt; 3 Human      female              56.3</span>
<span class="co">#&gt; 4 Hutt       hermaphroditic    1358  </span>
<span class="co">#&gt; 5 Kaminoan   female             NaN  </span>
<span class="co">#&gt; 6 Mirialan   female              53.1</span>
<span class="co">#&gt; 7 Tholothian female              50  </span>
<span class="co">#&gt; 8 Togruta    female              57  </span>
<span class="co">#&gt; 9 Twi'lek    female              55</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="condition-handling">Condition handling<a class="anchor" aria-label="anchor" href="#condition-handling"></a>
</h2>
<p>By default, errors and warnings get caught and composed in the log:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">errord_output</span> <span class="op">&lt;-</span> <span class="va">starwars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">r_select</span><span class="op">(</span><span class="va">height</span>, <span class="va">mass</span>, <span class="va">species</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span> 
  <span class="fu">r_group_by</span><span class="op">(</span><span class="va">species</span>, <span class="va">sx</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span> <span class="co"># typo, "sx" instead of "sex"</span>
  <span class="fu">r_filter</span><span class="op">(</span><span class="va">sex</span> <span class="op">!=</span> <span class="st">"male"</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span>
  <span class="fu">r_summarise</span><span class="op">(</span>mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mass</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">errord_output</span>
<span class="co">#&gt; ✘ Value computed unsuccessfully:</span>
<span class="co">#&gt; ---------------</span>
<span class="co">#&gt; Nothing</span>
<span class="co">#&gt; ---------------</span>
<span class="co">#&gt; This is an object of type `chronicle`.</span>
<span class="co">#&gt; Retrieve the value of this object with pick(.c, "value").</span>
<span class="co">#&gt; To read the log of this object, call read_log().</span></code></pre></div>
<p>Reading the log tells you which function failed, and with which error message:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/read_log.html">read_log</a></span><span class="op">(</span><span class="va">errord_output</span><span class="op">)</span>
<span class="co">#&gt; [1] "Complete log:"                                                                                                                                                    </span>
<span class="co">#&gt; [2] "✔ select(height,mass,species,sex) ran successfully at 2022-04-23 13:04:42"                                                                                        </span>
<span class="co">#&gt; [3] "✘ group_by(species,sx) ran unsuccessfully with following exception: Must group by variables found in `.data`.\n✖ Column `sx` is not found. at 2022-04-23 13:04:42"</span>
<span class="co">#&gt; [4] "✘ filter(sex != \"male\") ran unsuccessfully with following exception: Pipeline failed upstream at 2022-04-23 13:04:42"                                           </span>
<span class="co">#&gt; [5] "✘ summarise(mean(mass, na.rm = TRUE)) ran unsuccessfully with following exception: Pipeline failed upstream at 2022-04-23 13:04:42"                               </span>
<span class="co">#&gt; [6] "Total running time: 0.0490458011627197 secs"</span></code></pre></div>
<p>It is also possible to only capture errors, or catpure errors, warnings and messages using the <code>strict</code> parameter of <code><a href="reference/record.html">record()</a></code></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Only errors:</span>

<span class="va">r_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">sqrt</span>, strict <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="fu">r_sqrt</span><span class="op">(</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="reference/read_log.html">read_log</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning in .f(...): NaNs produced</span>
<span class="co">#&gt; [1] "Complete log:"                                   </span>
<span class="co">#&gt; [2] "✔ sqrt() ran successfully at 2022-04-23 13:04:43"</span>
<span class="co">#&gt; [3] "Total running time: 0.000287055969238281 secs"</span>

<span class="co"># Errors and warnings:</span>

<span class="va">r_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">sqrt</span>, strict <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="fu">r_sqrt</span><span class="op">(</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="reference/read_log.html">read_log</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] "Complete log:"                                                                             </span>
<span class="co">#&gt; [2] "✘ sqrt() ran unsuccessfully with following exception: NaNs produced at 2022-04-23 13:04:43"</span>
<span class="co">#&gt; [3] "Total running time: 0.00028681755065918 secs"</span>

<span class="co"># Errors, warnings and messages</span>

<span class="va">my_f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"this is a message"</span><span class="op">)</span>
  <span class="fl">10</span>
<span class="op">}</span>

<span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">my_f</span>, strict <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> |&gt;
                         <span class="fu"><a href="reference/read_log.html">read_log</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] "Complete log:"                                                                                   </span>
<span class="co">#&gt; [2] "✘ my_f() ran unsuccessfully with following exception: this is a message\n at 2022-04-23 13:04:43"</span>
<span class="co">#&gt; [3] "Total running time: 0.000364780426025391 secs"</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="advanced-logging">Advanced logging<a class="anchor" aria-label="anchor" href="#advanced-logging"></a>
</h2>
<p>You can provide a function to <code><a href="reference/record.html">record()</a></code>, which will be evaluated on the output. This makes it possible to, for example, monitor the size of a data frame throughout the pipeline:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">r_group_by</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">group_by</span><span class="op">)</span>
<span class="va">r_select</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">select</span>, .g <span class="op">=</span> <span class="va">dim</span><span class="op">)</span>
<span class="va">r_summarise</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">summarise</span>, .g <span class="op">=</span> <span class="va">dim</span><span class="op">)</span>
<span class="va">r_filter</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/record.html">record</a></span><span class="op">(</span><span class="va">filter</span>, .g <span class="op">=</span> <span class="va">dim</span><span class="op">)</span>

<span class="va">output_pipe</span> <span class="op">&lt;-</span> <span class="va">starwars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">r_select</span><span class="op">(</span><span class="va">height</span>, <span class="va">mass</span>, <span class="va">species</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span>
  <span class="fu">r_group_by</span><span class="op">(</span><span class="va">species</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span>
  <span class="fu">r_filter</span><span class="op">(</span><span class="va">sex</span> <span class="op">!=</span> <span class="st">"male"</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-equals-grapes.html">%&gt;=%</a></span>
  <span class="fu">r_summarise</span><span class="op">(</span>mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mass</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The <code>$log_df</code> element of a <code>chronicle</code> object contains detailled information:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/pick.html">pick</a></span><span class="op">(</span><span class="va">output_pipe</span>, <span class="st">"log_df"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 × 10</span>
<span class="co">#&gt;   ops_number outcome   `function` arguments          message start_time         </span>
<span class="co">#&gt;        &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;              &lt;chr&gt;   &lt;dttm&gt;             </span>
<span class="co">#&gt; 1          1 ✔ Success select     "height,mass,spec… NA      2022-04-23 13:04:43</span>
<span class="co">#&gt; 2          2 ✔ Success group_by   "species,sex"      NA      2022-04-23 13:04:43</span>
<span class="co">#&gt; 3          3 ✔ Success filter     "sex != \"male\""  NA      2022-04-23 13:04:43</span>
<span class="co">#&gt; 4          4 ✔ Success summarise  "mean(mass, na.rm… NA      2022-04-23 13:04:43</span>
<span class="co">#&gt; # … with 4 more variables: end_time &lt;dttm&gt;, run_time &lt;drtn&gt;, g &lt;list&gt;,</span>
<span class="co">#&gt; #   lag_outcome &lt;chr&gt;</span></code></pre></div>
<p>It is thus possible to take a look at the output of the function provided (<code><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim()</a></code>) using <code><a href="reference/check_g.html">check_g()</a></code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/check_g.html">check_g</a></span><span class="op">(</span><span class="va">output_pipe</span><span class="op">)</span>
<span class="co">#&gt;   ops_number  function     g</span>
<span class="co">#&gt; 1          1    select 87, 4</span>
<span class="co">#&gt; 2          2  group_by    NA</span>
<span class="co">#&gt; 3          3    filter 23, 4</span>
<span class="co">#&gt; 4          4 summarise  9, 3</span></code></pre></div>
<p>We can see that the dimension of the dataframe was (87, 4) after the call to <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code>, (23, 4) after the call to <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code> and finally (9, 3) after the call to <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="thanks">Thanks<a class="anchor" aria-label="anchor" href="#thanks"></a>
</h2>
<p>I’d like to thank <a href="https://github.com/armcn" class="external-link">armcn</a>, <a href="https://github.com/Kupac" class="external-link">Kupac</a> for their blog posts (<a href="https://kupac.gitlab.io/biofunctor/2019/05/25/maybe-monad-in-r/" class="external-link">here</a>) and packages (<a href="https://armcn.github.io/maybe/" class="external-link">maybe</a>) which inspired me to build this package. Thank you as well to <a href="https://community.rstudio.com/t/help-with-writing-a-custom-pipe-and-environments/133447/2?u=brodriguesco" class="external-link">TimTeaFan</a> for his help with writing the <code>%&gt;=%</code> infix operator, <a href="https://community.rstudio.com/t/best-way-to-catch-rlang-errors-consistently/131632/5?u=brodriguesco" class="external-link">nigrahamuk</a> for showing me a nice way to catch errors, and finally <a href="https://community.rstudio.com/t/how-to-do-call-a-dplyr-function/131396/2?u=brodriguesco" class="external-link">Mwavu</a> for pointing me towards the right direction with an issue I’ve had as I started working on this package.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/b-rodrigues/chronicler/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/b-rodrigues/chronicler/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing chronicler</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Bruno Rodrigues <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3211-3689" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bruno Rodrigues.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
